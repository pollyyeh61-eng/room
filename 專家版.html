<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>V-Commander | ç›´æ’­æ•™å®¤å°ˆå®¶ç‰ˆ</title>
    <style>
        :root { 
            --left-width: 180px; 
            --right-width: 280px; 
            --soft-gold: #e5c07b; 
            --gold-glow: rgba(229, 192, 123, 0.4); 
            --bg-dark: #000; 
        }
        body { 
            margin: 0; 
            background: var(--bg-dark); 
            color: #d0d0d0; 
            font-family: sans-serif; 
            display: flex; 
            height: 100vh; 
            overflow: hidden; 
        }

        /* å´é‚Šçµæ§‹ */
        .side-zone { background: #050505; border: 1px solid #1a1a1a; display: flex; flex-shrink: 0; }
        .left-zone { width: var(--left-width); }
        .right-zone { width: var(--right-width); }

        .side-tabs { 
            width: 48px; 
            background: #080808; 
            display: flex; 
            flex-direction: column; 
            padding: 20px 0 100px 0; 
            justify-content: space-between; 
            align-items: center; 
        }

        /* æŒ‰éµå°ºå¯¸ 18-20 é»ƒé‡‘æ¯”ä¾‹ [cite: 2026-01-22] */
        .tab-btn { 
            width: 36px; 
            flex-grow: 1; 
            max-height: 95px; 
            margin: 2px 0;
            border: 1px solid #1a1a1a; 
            background: #080808;
            cursor: pointer; 
            writing-mode: vertical-lr; 
            text-align: center; 
            white-space: nowrap; 
            opacity: 0.7; 
            transition: 0.5s; 
            font-size: 14px; 
            color: var(--soft-gold); 
            letter-spacing: 2px;
            position: relative;
            overflow: hidden;
        }

        .tab-btn:hover { 
            opacity: 1; 
            border-color: var(--soft-gold); 
            box-shadow: 0 0 15px var(--gold-glow); 
            color: #fff;
        }

        .active-blue { border-color: #4285f4 !important; color: #4285f4 !important; opacity: 1; }
        .active-red { border-color: #ff4d4d !important; color: #ff4d4d !important; opacity: 1; }

        /* ä¸»è¦–è¨Šèˆå° */
        #center-stage { 
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
            position: relative; 
            background: #000; 
            border-left: 1px solid #111; 
            border-right: 1px solid #111; 
        }
        .video-container { 
            width: 95%; 
            aspect-ratio: 16 / 10; 
            margin: auto; 
            border: 1px solid #151515; 
            position: relative; 
            background: #000;
        }
        #main-display { width: 100%; height: 100%; object-fit: contain; }
        #commander-pip { 
            position: absolute; 
            top: 15px; 
            right: 15px; 
            width: 160px; 
            height: auto; 
            border: 1px solid var(--soft-gold); 
            transform: scaleX(-1); 
            z-index: 100; 
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
        }
        
        /* æˆ°æƒ…æ—¥èªŒèˆ‡æ¨™é¡Œ */
        #status-log { 
            flex-grow: 1; 
            font-size: 12px; 
            color: #555; 
            overflow-y: auto; 
            display: flex; 
            flex-direction: column-reverse; 
            padding: 15px; 
            line-height: 1.8; 
            white-space: nowrap; 
        }
        .log-entry { border-bottom: 1px solid #111; padding-bottom: 2px; margin-bottom: 4px; }
        .side-title { 
            padding: 15px; 
            border-bottom: 1px solid #151515; 
            color: #444; 
            font-size: 12px; 
            letter-spacing: 3px; 
            font-weight: bold; 
        }
        #matrix-container { flex-grow: 1; display: grid; gap: 5px; padding: 10px; align-content: start; }
        .unit-dot { border: 1px solid #151515; background: #070707; color: #333; text-align: center; font-size: 11px; padding: 5px 0; }
    </style>
</head>
<body onload="initSystem();">

<div class="side-zone left-zone">
    <div class="side-content">
        <div class="side-title">MONITOR POOL</div>
        <div id="matrix-container"></div>
    </div>
    <div class="side-tabs" style="border-left: 1px solid #151515;">
        <button class="tab-btn" onclick="setScale(10)">10äººè¦æ¨¡</button>
        <button class="tab-btn" onclick="setScale(50)">50äººè¦æ¨¡</button>
        <button class="tab-btn" onclick="setScale(100)">100äººè¦æ¨¡</button>
    </div>
</div>

<div id="center-stage">
    <div class="video-container">
        <video id="main-display" autoplay playsinline></video>
        <video id="commander-pip" autoplay playsinline muted></video>
    </div>
</div>

<div class="side-zone right-zone">
    <div class="side-tabs" style="border-right: 1px solid #151515;">
        <button class="tab-btn" onclick="window.location.href='index.html'" style="color: #ff9800; font-weight: bold;">å›ä¸»ç•«é¢</button>
        <button id="live-btn" class="tab-btn" onclick="toggleLive()">å»ºç«‹æ•™å®¤</button>
        <button id="rec-btn" class="tab-btn" onclick="toggleRec()">éŒ„å½±å­˜æª”</button>
        <button id="pip-btn" class="tab-btn" onclick="togglePIP()">å­æ¯ç•«é¢</button>
        <button id="share-btn" class="tab-btn" onclick="toggleShare()">åˆ†äº«è¦–çª—</button>
        <button class="tab-btn" onclick="window.open('https://line.me/')" style="color:#00c300aa;">LINE</button>
    </div>
    <div class="side-content">
        <div class="side-title">ç›´æ’­æ—¥èªŒ</div>
        <div id="status-log"></div>
    </div>
</div>

<script>
    let cameraStream = null;
    let isPIP = true;

    async function initSystem() {
        await startCamera();
        setScale(10);
        addLog("ğŸš€ ç›´æ’­å°ˆç”¨ç³»çµ±å·²å•Ÿå‹• [2026-01-27]"); [cite: 2026-01-07]
    }

    async function startCamera() {
        try {
            // å¼·åˆ¶å•Ÿå‹•ç›¸æ©Ÿä¸¦æ³¨å…¥è¦–è¨Šå…ƒä»¶
            cameraStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
            document.getElementById('commander-pip').srcObject = cameraStream;
            document.getElementById('main-display').srcObject = cameraStream;
        } catch (e) { 
            addLog("âš ï¸ é¡é ­å•Ÿå‹•å¤±æ•—ï¼Œè«‹æª¢æŸ¥æ¬Šé™"); 
        }
    }

    // å¯¦è³ªä¸²æµé‚è¼¯ï¼šå»ºç«‹ä¸€å€‹å¯åˆ†äº«çš„ WebRTC æˆ¿é–“
    function toggleLive() {
        const btn = document.getElementById('live-btn');
        // å»ºç«‹å”¯ä¸€æˆ¿é–“åç¨±
        const roomID = "V-Studio-" + Math.floor(Math.random()*9000 + 1000);
        const meetUrl = `https://meet.jit.si/${roomID}`;

        if (btn.classList.toggle('active-blue')) {
            btn.innerText = "ç›´æ’­ä¸­...";
            addLog(`ğŸ“¡ ç›´æ’­æ•™å®¤å·²å»ºç«‹ï¼š${roomID}`); [cite: 2026-01-07]
            addLog(`ğŸ”— å­¸ç”Ÿå…¥å£ï¼š${meetUrl}`); [cite: 2026-01-07]
            // è‡ªå‹•é–‹å•Ÿè¦–è¨Šåˆ†é ä¾›æ‚¨æ“ä½œç›´æ’­
            window.open(meetUrl, '_blank');
        } else {
            btn.innerText = "å»ºç«‹æ•™å®¤";
            addLog("â¹ï¸ ç›´æ’­å·²é›¢ç·š");
        }
    }

    async function toggleShare() {
        try {
            const shareStream = await navigator.mediaDevices.getDisplayMedia({ video: true });
            document.getElementById('main-display').srcObject = shareStream;
            addLog("ğŸ–¥ï¸ æ­£åœ¨åŒæ­¥åˆ†äº«æ•™æè¦–çª—"); [cite: 2026-01-07]
            shareStream.getVideoTracks()[0].onended = () => { resetToCamera(); };
        } catch (e) { addLog("âš ï¸ åˆ†äº«æ“ä½œå–æ¶ˆ"); }
    }

    function resetToCamera() {
        if (cameraStream) {
            document.getElementById('main-display').srcObject = cameraStream;
            addLog("ğŸ”„ åˆ†äº«çµæŸï¼Œé‚„åŸé¡é ­ç•«é¢");
        }
    }

    function togglePIP() {
        isPIP = !isPIP;
        document.getElementById('commander-pip').style.display = isPIP ? 'block' : 'none';
        addLog(isPIP ? "ğŸ–¼ï¸ é–‹å•Ÿå­æ¯ç•«é¢" : "ğŸ–¼ï¸ éš±è—å­æ¯ç•«é¢");
    }

    function setScale(num) {
        const container = document.getElementById('matrix-container');
        container.innerHTML = '';
        container.style.gridTemplateColumns = `repeat(${num <= 10 ? 1 : 4}, 1fr)`;
        for (let i = 1; i <= num; i++) {
            const dot = document.createElement('div');
            dot.className = 'unit-dot';
            dot.innerText = i;
            container.appendChild(dot);
        }
        addLog(`ğŸ“Š å­¸å“¡è¦æ¨¡è¨­å®šï¼š${num} äºº`);
    }

    function toggleRec() {
        const btn = document.getElementById('rec-btn');
        btn.classList.toggle('active-red');
        btn.innerText = btn.classList.contains('active-red') ? "éŒ„è£½ä¸­..." : "éŒ„å½±å­˜æª”";
        addLog(btn.classList.contains('active-red') ? "ğŸ”´ èª²ç¨‹å…¨ç·šéŒ„å½±ä¸­" : "âœ… éŒ„å½±æª”æ¡ˆå·²å„²å­˜");
    }

    function addLog(txt) {
        const log = document.getElementById('status-log');
        const entry = document.createElement('div');
        entry.className = 'log-entry';
        const now = new Date();
        const timeStr = `${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
        entry.innerHTML = `<span style="color:#222;margin-right:8px;">${timeStr}</span> ${txt}`;
        log.prepend(entry);
    }
</script>
</body>
</html>
