<style>
    :root { 
        --side-width: 180px; 
        --soft-gold: #e5c07b; 
    }

    /* å·¦å´å‹•æ…‹æ± è¨­å®š */
    #left-pool { 
        width: var(--side-width); 
        background: #050505; 
        border-right: 1px solid #1a1a1a; 
        display: flex; 
        flex-direction: column; 
        align-items: center; /* è®“ä»£è¡¨æ¡†å±…ä¸­ */
        padding-top: 10px;
    }

    /* [æ ¸å¿ƒä¿®æ”¹] å‹•æ…‹ä»£è¡¨æ¡† [cite: 2026-01-27] */
    .monitor-frame {
        width: 150px; /* ç¸®å°å°ºå¯¸ï¼Œä¸å¡«æ»¿å‹•æ…‹æ±  */
        aspect-ratio: 16 / 9;
        border: 1px solid #333; /* å¹³æ™‚æš—è‰² */
        background: #000;
        margin-bottom: 15px;
        position: relative;
        overflow: hidden;
        transition: all 0.5s;
    }

    /* å•Ÿå‹•æ™‚çš„æ·¡é‡‘è‰²é‚Šæ¡†æ•ˆæœ */
    .monitor-active {
        border-color: var(--soft-gold);
        box-shadow: 0 0 10px rgba(229, 192, 123, 0.2);
    }

    #opponent-video {
        width: 100%; height: 100%; object-fit: cover; display: none;
    }

    .frame-label {
        position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.7);
        color: var(--soft-gold); font-size: 9px; text-align: center; letter-spacing: 1px;
    }

    /* å´æ¨™æ–‡å­—æ·¡é‡‘è‰²èˆ‡å¾®ç¸®è¨­å®š [cite: 2026-01-22, 2026-01-27] */
    .tab-btn {
        color: var(--soft-gold);
        font-size: 10px;
        letter-spacing: 5px;
        opacity: 0.8;
    }
</style>

<div id="left-pool">
    <div class="side-title">å‹•æ…‹ç›£æ§æ± </div>
    <div id="pool-frame" class="monitor-frame">
        <video id="opponent-video" autoplay playsinline></video>
        <div class="frame-label">EXT-MONITOR // 01</div>
    </div>
    <div id="pool-status" style="font-size:10px; color:#222; width:150px;">
        [cite: 2026-01-07] ç³»çµ±å¾…å‘½ä¸­...
    </div>
</div>

<script>
    async function startPIPMode() {
        const mainV = document.getElementById('main-display');
        const sideV = document.getElementById('opponent-video');
        const frame = document.getElementById('pool-frame');
        const btn = document.getElementById('pip-btn');

        try {
            // 1. æŠ“å–ç°¡å ±æ”¾åˆ°ä¸­é–“ä¸»ç•«é¢ [cite: 2026-01-27]
            const presentationStream = await navigator.mediaDevices.getDisplayMedia({ video: true });
            mainV.srcObject = presentationStream;
            mainV.style.transform = "none";

            // 2. å°æ–¹ç•«é¢é€²å…¥å·¦å´ä»£è¡¨æ¡† [cite: 2026-01-27]
            sideV.srcObject = window.localStream; 
            sideV.style.display = "block";
            frame.classList.add('monitor-active');
            
            btn.classList.add('active-pip');
            addLog("ğŸ“¡ å¯©é–±æ¨¡å¼ï¼šç°¡å ±åµŒå…¥ä¸»è»¸ï¼Œå¤–åŒ…å•†é€²å…¥å´æ± ç›£æ§ [cite: 2026-01-27]");

            presentationStream.getVideoTracks()[0].onended = () => {
                mainV.srcObject = window.localStream;
                mainV.style.transform = "scaleX(-1)";
                sideV.style.display = "none";
                frame.classList.remove('monitor-active');
                btn.classList.remove('active-pip');
            };
        } catch (err) { addLog("â„¹ï¸ æŒ‡ä»¤æ’¤å›"); }
    }
</script>
