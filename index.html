<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>V-Commander | è‘‰æ ¡é•·æˆ°æƒ…ç›´æ’­ç³»çµ±</title>
    <style>
        :root { 
            --gold: #e5c07b; 
            --bg-black: #050505;
            --border-gray: #1a1a1a;
            --text-gray: #888;
        }
        body { margin: 0; background: #000; color: #d0d0d0; font-family: "Microsoft JhengHei", sans-serif; display: flex; height: 100vh; overflow: hidden; }

        /* å·¦å´ï¼šå­¸å“¡ç›£æ§æ±  */
        .left-panel { width: 180px; display: flex; border-right: 1px solid var(--border-gray); }
        .monitor-pool { flex-grow: 1; display: flex; flex-direction: column; }
        .pool-title { padding: 10px; color: #444; font-size: 11px; letter-spacing: 2px; border-bottom: 1px solid var(--border-gray); }
        #matrix { padding: 10px; display: grid; gap: 5px; }
        .student-slot { border: 1px solid #111; background: #080808; color: #333; font-size: 10px; padding: 6px; text-align: center; }
        .student-slot.online { border-color: #004422; color: #00ff88; }

        /* è¦æ¨¡æŒ‰éˆ•æ¬„ */
        .scale-tabs { width: 45px; display: flex; flex-direction: column; border-left: 1px solid var(--border-gray); background: #080808; }
        .v-btn { 
            flex-grow: 1; border: none; border-bottom: 1px solid #111; background: transparent;
            writing-mode: vertical-lr; color: var(--gold); font-size: 12px; cursor: pointer;
            letter-spacing: 2px; opacity: 0.6; transition: 0.3s;
        }
        .v-btn:hover { opacity: 1; background: #111; }

        /* ä¸­å¤®ï¼šä¸»ç•«é¢ */
        .center-stage { flex-grow: 1; padding: 15px; display: flex; flex-direction: column; }
        .main-view { flex-grow: 1; background: #000; border: 1px solid var(--border-gray); position: relative; }
        video { width: 100%; height: 100%; object-fit: contain; }

        /* å³å´ï¼šåŠŸèƒ½èˆ‡é€šè¨Š */
        .right-panel { width: 260px; display: flex; border-left: 1px solid var(--border-gray); }
        .func-tabs { width: 45px; display: flex; flex-direction: column; border-right: 1px solid var(--border-gray); background: #080808; }
        
        .side-content { flex-grow: 1; display: flex; flex-direction: column; }
        .comm-header { padding: 12px; display: flex; gap: 8px; border-bottom: 1px solid var(--border-gray); }
        .comm-btn { 
            flex: 1; padding: 8px; background: #0a0a0a; border: 1px solid #222; 
            color: var(--gold); font-size: 11px; text-decoration: none; text-align: center;
        }
        .log-zone { flex-grow: 1; padding: 15px; display: flex; flex-direction: column; }
        .log-title { color: #444; font-size: 11px; margin-bottom: 10px; letter-spacing: 2px; text-align: right; }
        #status-log { flex-grow: 1; overflow-y: auto; font-size: 12px; color: #555; display: flex; flex-direction: column-reverse; gap: 8px; }

        .active-rec { color: #ff4d4d !important; text-shadow: 0 0 5px #ff4d4d; }
    </style>
</head>
<body onload="init()">

<div class="left-panel">
    <div class="monitor-pool">
        <div class="pool-title">å­¸å“¡ç›£æ§æ± </div>
        <div id="matrix"></div>
    </div>
    <div class="scale-tabs">
        <button class="v-btn" onclick="setScale(10)">10äººè¦æ¨¡</button>
        <button class="v-btn" onclick="setScale(20)">20äººè¦æ¨¡</button>
        <button class="v-btn" onclick="setScale(30)">30äººè¦æ¨¡</button>
        <button class="v-btn" onclick="setScale(40)">40äººè¦æ¨¡</button>
        <button class="v-btn" onclick="setScale(50)">50äººè¦æ¨¡</button>
        <button class="v-btn" onclick="setScale(100)">100äººè¦æ¨¡</button>
    </div>
</div>

<div class="center-stage">
    <div class="main-view">
        <video id="v-main" autoplay playsinline></video>
    </div>
</div>

<div class="right-panel">
    <div class="func-tabs">
        <button class="v-btn" style="color:#4285f4;">ç›´æ’­èª²ç¨‹</button>
        <button id="rec-btn" class="v-btn" onclick="toggleRec()">éŒ„å½±å­˜æª”</button>
        <button class="v-btn" onclick="addLog('ğŸ“¢ å»£æ’­æŒ‡ä»¤å·²ç™¼é€')">å»£æ’­æŒ‡ä»¤</button>
        <button class="v-btn">å­æ¯ç•«é¢</button>
        <button class="v-btn">æˆ‘çš„é ­åƒ</button>
        <button class="v-btn">åˆ†äº«è¦–çª—</button>
    </div>
    <div class="side-content">
        <div class="comm-header">
            <a href="https://line.me" target="_blank" class="comm-btn">LINE</a>
            <a href="https://chat.google.com" target="_blank" class="comm-btn">G-CHAT</a>
        </div>
        <div class="log-zone">
            <div class="log-title">æˆ°æƒ…æ—¥èªŒ</div>
            <div id="status-log"></div>
        </div>
    </div>
</div>

<script>
    let recorder, chunks = [];

    async function init() {
        const s = await navigator.mediaDevices.getUserMedia({video:true, audio:true});
        document.getElementById('v-main').srcObject = s;
        setScale(10);
        addLog("ğŸ¥ ç³»çµ±åˆå§‹åŒ–å®Œç•¢");
    }

    async function toggleRec() {
        const btn = document.getElementById('rec-btn');
        if (!recorder || recorder.state === "inactive") {
            try {
                const s = await navigator.mediaDevices.getDisplayMedia({video:true, audio:true});
                recorder = new MediaRecorder(s);
                chunks = [];
                recorder.ondataavailable = e => chunks.push(e.data);
                recorder.onstop = () => {
                    const blob = new Blob(chunks, {type:"video/webm"});
                    const a = document.createElement("a");
                    a.href = URL.createObjectURL(blob);
                    a.download = `è‘‰æ ¡é•·æˆ°æƒ…éŒ„å½±_${new Date().toLocaleDateString()}.webm`;
                    a.click();
                    s.getTracks().forEach(t => t.stop());
                };
                recorder.start();
                btn.classList.add('active-rec');
                addLog("ğŸ”´ é›²ç«¯éŒ„å½±å•Ÿå‹•");
            } catch(e) { addLog("âš ï¸ éŒ„å½±å–æ¶ˆ"); }
        } else {
            recorder.stop();
            btn.classList.remove('active-rec');
            addLog("âœ… éŒ„å½±çµæŸ");
        }
    }

    function setScale(n) {
        const m = document.getElementById('matrix');
        m.innerHTML = '';
        m.style.gridTemplateColumns = n <= 20 ? "1fr" : "repeat(2, 1fr)";
        for(let i=1; i<= (n>20?20:n); i++) {
            const d = document.createElement('div');
            d.className = 'student-slot' + (Math.random()>0.3?' online':'');
            d.innerText = `STUDENT-${i}`;
            m.appendChild(d);
        }
        addLog(`ğŸ“Š è¦æ¨¡åˆ‡æ›: ${n}äºº`);
    }

    function addLog(t) {
        const l = document.getElementById('status-log');
        const time = new Date().toLocaleTimeString('zh-TW', {hour12:false});
        l.innerHTML = `<div><span style="color:#333;margin-right:8px;">${time}</span> ${t}</div>` + l.innerHTML;
    }
</script>
</body>
</html>
